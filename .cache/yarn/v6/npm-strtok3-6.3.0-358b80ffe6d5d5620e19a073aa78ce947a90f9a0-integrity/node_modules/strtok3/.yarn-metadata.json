{
  "manifest": {
    "name": "strtok3",
    "version": "6.3.0",
    "description": "A promise based streaming tokenizer",
    "author": {
      "name": "Borewit",
      "url": "https://github.com/Borewit"
    },
    "funding": {
      "type": "github",
      "url": "https://github.com/sponsors/Borewit"
    },
    "scripts": {
      "clean": "del-cli lib/**/*.js lib/**/*.js.map lib/**/*.d.ts test/**/*.js test/**/*.js.map",
      "compile-src": "tsc -p lib",
      "compile-test": "tsc -p test",
      "compile": "npm run compile-src && npm run compile-test",
      "build": "npm run clean && npm run compile",
      "eslint": "eslint lib test --ext .ts --ignore-pattern *.d.ts",
      "lint-md": "remark -u preset-lint-recommended .",
      "lint": "npm run lint-md && npm run eslint",
      "fix": "eslint lib test --ext .ts --ignore-pattern *.d.ts --fix",
      "test": "mocha --require ts-node/register --require source-map-support/register --full-trace test/test.ts",
      "test-coverage": "nyc npm run test",
      "send-coveralls": "nyc report --reporter=text-lcov | coveralls",
      "send-codacy": "nyc report --reporter=text-lcov | codacy-coverage",
      "start": "npm run compile && npm run lint && npm run cover-test"
    },
    "engines": {
      "node": ">=10"
    },
    "repository": {
      "type": "git",
      "url": "https://github.com/Borewit/strtok3.git"
    },
    "license": "MIT",
    "main": "lib/index.js",
    "types": "lib/index.d.ts",
    "files": [
      "lib/**/*.js",
      "lib/**/*.d.ts"
    ],
    "bugs": {
      "url": "https://github.com/Borewit/strtok3/issues"
    },
    "devDependencies": {
      "@types/chai": "^4.3.0",
      "@types/debug": "^4.1.7",
      "@types/mocha": "^9.1.0",
      "@types/node": "^17.0.14",
      "@typescript-eslint/eslint-plugin": "^5.10.2",
      "@typescript-eslint/parser": "^5.10.2",
      "chai": "^4.3.6",
      "coveralls": "^3.1.1",
      "del-cli": "^4.0.1",
      "eslint": "^8.8.0",
      "eslint-config-prettier": "^8.3.0",
      "eslint-import-resolver-typescript": "^2.5.0",
      "eslint-plugin-import": "^2.25.4",
      "eslint-plugin-jsdoc": "^37.7.1",
      "eslint-plugin-node": "^11.1.0",
      "eslint-plugin-unicorn": "^40.1.0",
      "mocha": "^9.2.0",
      "nyc": "^15.1.0",
      "remark-cli": "^10.0.1",
      "remark-preset-lint-recommended": "^6.1.2",
      "source-map-support": "^0.5.21",
      "token-types": "^4.1.1",
      "ts-node": "^10.4.0",
      "typescript": "^4.5.5"
    },
    "dependencies": {
      "@tokenizer/token": "^0.3.0",
      "peek-readable": "^4.1.0"
    },
    "keywords": [
      "tokenizer",
      "reader",
      "token",
      "async",
      "promise",
      "parser",
      "decoder",
      "binary",
      "endian",
      "uint",
      "stream",
      "streaming"
    ],
    "nyc": {
      "check-coverage": false,
      "extension": [
        ".ts"
      ],
      "sourceMap": true,
      "instrument": true,
      "reporter": [
        "lcov",
        "text"
      ],
      "report-dir": "coverage"
    },
    "_registry": "npm",
    "_loc": "/data/data/com.termux/files/home/.cache/yarn/v6/npm-strtok3-6.3.0-358b80ffe6d5d5620e19a073aa78ce947a90f9a0-integrity/node_modules/strtok3/package.json",
    "readmeFilename": "README.md",
    "readme": "![Node.js CI](https://github.com/Borewit/strtok3/workflows/Node.js%20CI/badge.svg)\n[![NPM version](https://badge.fury.io/js/strtok3.svg)](https://npmjs.org/package/strtok3)\n[![npm downloads](http://img.shields.io/npm/dm/strtok3.svg)](https://npmcharts.com/compare/strtok3,token-types?start=1200&interval=30)\n[![DeepScan grade](https://deepscan.io/api/teams/5165/projects/8526/branches/103329/badge/grade.svg)](https://deepscan.io/dashboard#view=project&tid=5165&pid=8526&bid=103329)\n[![Known Vulnerabilities](https://snyk.io/test/github/Borewit/strtok3/badge.svg?targetFile=package.json)](https://snyk.io/test/github/Borewit/strtok3?targetFile=package.json)\n[![Total alerts](https://img.shields.io/lgtm/alerts/g/Borewit/strtok3.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Borewit/strtok3/alerts/)\n[![Codacy Badge](https://api.codacy.com/project/badge/Grade/59dd6795e61949fb97066ca52e6097ef)](https://www.codacy.com/app/Borewit/strtok3?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Borewit/strtok3&amp;utm_campaign=Badge_Grade)\n[![Language grade: JavaScript](https://img.shields.io/lgtm/grade/javascript/g/Borewit/strtok3.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/Borewit/strtok3/context:javascript)\n# strtok3\n\nA promise based streaming [*tokenizer*](#tokenizer) for [Node.js](http://nodejs.org) and browsers.\nThis node module is a successor of [strtok2](https://github.com/Borewit/strtok2).\n\nThe `strtok3` contains a few methods to turn different input into a [*tokenizer*](#tokenizer). Designed to\n*   Support a streaming environment\n*   Decoding of binary data, strings and numbers in mind\n*   Read [predefined](https://github.com/Borewit/token-types) or custom tokens.\n*   Optimized [*tokenizers*](#tokenizer) for reading from [file](#method-strtok3fromfile), [stream](#method-strtok3fromstream) or [buffer](#method-strtok3frombuffer).\n\nIt can read from:\n*   A file (taking a file path as an input)\n*   A Node.js [stream](https://nodejs.org/api/stream.html).\n*   A [Buffer](https://nodejs.org/api/buffer.html) or [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)\n*   HTTP chunked transfer provided by [@tokenizer/http](https://github.com/Borewit/tokenizer-http).\n*   Chunked [Amazon S3](https://aws.amazon.com/s3) access provided by [@tokenizer/s3](https://github.com/Borewit/tokenizer-s3).\n\n## Installation\n\n```sh\nnpm install strtok3\n```\n\n### Compatibility\n\nNPM module is compliant with [ECMAScript 2018 (ES9)](https://en.wikipedia.org/wiki/ECMAScript#9th_Edition_%E2%80%93_ECMAScript_2018).\n\n## API\n\nUse one of the methods to instantiate an [*abstract tokenizer*](#tokenizer):\n*   [strtok3.fromFile](#method-strtok3fromfile)\n*   [strtok3.fromStream](#method-strtok3fromstream)\n*   [strtok3.fromBuffer](#method-strtok3fromBuffer)\n*   [strtok3.fromUint8Array](#method-strtok3fromUint8Array)\n\n### strtok3 methods\n\nAll of the strtok3 methods return a [*tokenizer*](#tokenizer), either directly or via a promise.\n\n#### Method `strtok3.fromFile()`\n\n| Parameter | Type                  | Description                |\n|-----------|-----------------------|----------------------------|\n| path      | Path to file (string) | Path to file to read from  |\n\n> __Note__: that [file-information](#file-information) is automatically added.\n\nReturns, via a promise, a [*tokenizer*](#tokenizer) which can be used to parse a file.\n\n```js\nconst strtok3 = require('strtok3');\nconst Token = require('token-types');\n    \n(async () => {\n\n  const tokenizer = await strtok3.fromFile(\"somefile.bin\");\n         try {\n    const myNumber = await tokenizer.readToken(Token.UINT8);\n    console.log(`My number: ${myNumber}`);\n  } finally {\n    tokenizer.close(); // Close the file\n  } \n})();\n\n```\n\n#### Method `strtok3.fromStream()`\n\nCreate [*tokenizer*](#tokenizer) from a node.js [readable stream](https://nodejs.org/api/stream.html#stream_class_stream_readable).\n\n| Parameter |  Optional | Type                                                                        | Description              |\n|-----------|-----------|-----------------------------------------------------------------------------|--------------------------|\n| stream    | no        | [Readable](https://nodejs.org/api/stream.html#stream_class_stream_readable) | Stream to read from      |\n| fileInfo  | yes       | [IFileInfo](#IFileInfo)                                                     | Provide file information |\n\nReturns a [*tokenizer*](#tokenizer), via a Promise, which can be used to parse a buffer.\n\n```js\nconst strtok3 = require('strtok3');\nconst Token = require('token-types');\n\nstrtok3.fromStream(stream).then(tokenizer => {\n  return tokenizer.readToken(Token.UINT8).then(myUint8Number => {\n    console.log(`My number: ${myUint8Number}`);\n  });\n});\n```\n\n#### Method `strtok3.fromBuffer()`\n\n| Parameter  | Optional | Type                                             | Description                            |\n|------------|----------|--------------------------------------------------|----------------------------------------|\n| uint8Array | no       | [Uint8Array](https://nodejs.org/api/buffer.html) | Uint8Array or Buffer to read from      |\n| fileInfo   | yes      | [IFileInfo](#IFileInfo)                          | Provide file information               |\n\nReturns a [*tokenizer*](#tokenizer) which can be used to parse the provided buffer.\n\n```js\nconst strtok3 = require('strtok3');\n    \nconst tokenizer = strtok3.fromBuffer(buffer);\n\ntokenizer.readToken(Token.UINT8).then(myUint8Number => {\n  console.log(`My number: ${myUint8Number}`);\n});\n```\n\n## Tokenizer\nThe tokenizer allows us to *read* or *peek* from the *tokenizer-stream*. The *tokenizer-stream* is an abstraction of a [stream](https://nodejs.org/api/stream.html), file or [Buffer](https://nodejs.org/api/buffer.html).\nIt can also be translated in chunked reads, as done in [@tokenizer/http](https://github.com/Borewit/tokenizer-http);\n\nWhat is the difference with Nodejs.js stream?\n*   The *tokenizer-stream* supports jumping / seeking in a the *tokenizer-stream* using [`tokenizer.ignore()`](#method-tokenizerignore)\n*   In addition to *read* methods, it has *peek* methods, to read a ahead and check what is coming.\n\nThe [tokenizer.position](#attribute-tokenizerposition) keeps tracks of the read position.\n\n### strtok3 attributes\n\n#### Attribute `tokenizer.fileInfo`\nOptional attribute describing the file information, see [IFileInfo](#IFileInfo)\n\n#### Attribute `tokenizer.position`\nPointer to the current position in the [*tokenizer*](#tokenizer) stream.\nIf a *position* is provided to a *read* or *peek* method, is should be, at least, equal or greater than this value.\n\n### Tokenizer methods \n\nThere are two kind of methods:\n1.   *read* methods: used to read a *token* of [Buffer](https://nodejs.org/api/buffer.html) from the [*tokenizer*](#tokenizer). The position of the *tokenizer-stream* will advance with the size of the token.\n2.   *peek* methods: same as the read, but it will *not* advance the pointer. It allows to read (peek) ahead.\n\n#### Method `tokenizer.readBuffer()`\n\nRead buffer from stream.\n`readBuffer(buffer, options?)`\n\n| Parameter  | Type                                                           | Description                                                                                                                                                                                                                            |\n|------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| buffer     | [Buffer](https://nodejs.org/api/buffer.html) &#124; Uint8Array | Target buffer to write the data read to                                                                                                                                                                                                |\n| options    | [IReadChunkOptions](#ireadchunkoptions)                        | An integer specifying the number of bytes to read                                                                                                                                                                                      |\n\nReturn value `Promise<number>` Promise with number of bytes read. The number of bytes read maybe if less, *mayBeLess* flag was set.\n\n#### Method `tokenizer.peekBuffer()`\n\nPeek (read ahead) buffer from [*tokenizer*](#tokenizer)\n`peekBuffer(buffer,  options?)`\n\n| Parameter  | Type                                    | Description                                         |\n|------------|-----------------------------------------|-----------------------------------------------------|\n| buffer     | Buffer &#124; Uint8Array                | Target buffer to write the data read (peeked) to.   |\n| options    | [IReadChunkOptions](#ireadchunkoptions) | An integer specifying the number of bytes to read.  |                                                                                                                           |\n\nReturn value `Promise<number>` Promise with number of bytes read. The number of bytes read maybe if less, *mayBeLess* flag was set.\n\n#### Method `tokenizer.readToken()`\n\nRead a *token* from the tokenizer-stream.\n`readToken(token, position?)`\n\n| Parameter  | Type                    | Description                                                                                                           |\n|------------|-------------------------|---------------------------------------------------------------------------------------------------------------------- |\n| token      | [IGetToken](#IGetToken) | Token to read from the tokenizer-stream.                                                                              |\n| position?  | number                  | Offset where to begin reading within the file. If position is null, data will be read from the current file position. |\n\nReturn value `Promise<number>`. Promise with number of bytes read. The number of bytes read maybe if less, *mayBeLess* flag was set.\n\n#### Method `tokenizer.peekToken()`\n\nPeek a *token* from the [*tokenizer*](#tokenizer).\n`peekToken(token, position?)`\n\n| Parameter  | Type                       | Description                                                                                                             |\n|------------|----------------------------|-------------------------------------------------------------------------------------------------------------------------|\n| token      | [IGetToken<T>](#IGetToken) | Token to read from the tokenizer-stream.                                                                                |\n| position?  | number                     | Offset where to begin reading within the file. If position is null, data will be read from the current file position.   |\n\nReturn value `Promise<T>` Promise with token value peeked from the [*tokenizer*](#tokenizer).\n\n#### Method `tokenizer.readNumber()`\n\nPeek a numeric [*token*](#token) from the [*tokenizer*](#tokenizer).\n`readNumber(token)`\n\n| Parameter  | Type                            | Description                                        |\n|------------|---------------------------------|----------------------------------------------------|\n| token      | [IGetToken<number>](#IGetToken) | Numeric token to read from the tokenizer-stream.   |\n\nReturn value `Promise<number>` Promise with number peeked from the *tokenizer-stream*.\n\n#### Method `tokenizer.ignore()`\n\nAdvanse the offset pointer with the number of bytes provided. \n`ignore(length)`\n\n| Parameter  | Type   | Description                                                          |\n|------------|--------|----------------------------------------------------------------------|\n| ignore     | number | Numeric of bytes to ignore. Will advance the `tokenizer.position`    |\n\nReturn value `Promise<number>` Promise with number peeked from the *tokenizer-stream*.\n\n#### Method `tokenizer.close()`\nClean up resources, such as closing a file pointer if applicable.\n\n### IReadChunkOptions\n\nEach attribute is optional:\n\n| Attribute | Type    | Description                                                                                                                                                                                                                   |\n|-----------|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| offset    | number  | The offset in the buffer to start writing at; if not provided, start at 0                                                                                                                                                     |\n| length    | number  | Requested number of bytes to read.                                                                                                                                                                                            |\n| position  | number  | Position where to peek from the file. If position is null, data will be read from the [current file position](#attribute-tokenizerposition). Position may not be less then [tokenizer.position](#attribute-tokenizerposition) |\n| mayBeLess | boolean | If and only if set, will not throw an EOF error if less then the requested *mayBeLess* could be read.                                                                                                                         |\n\nExample:\n```js\n  tokenizer.peekBuffer(buffer, {mayBeLess: true});\n```\n\n## IFileInfo\n\nFile information interface which describes the underlying file, each attribute is optional.\n\n| Attribute | Type    | Description                                                                                       |\n|-----------|---------|---------------------------------------------------------------------------------------------------|\n| size      | number  | File size in bytes                                                                                | \n| mimeType  | number  | [MIME-type](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types) of file. |\n| path      | number  | File path                                                                                         |\n| url       | boolean | File URL                                                                                          |\n\n## Token\n\nThe *token* is basically a description what to read form the [*tokenizer-stream*](#tokenizer). \nA basic set of *token types* can be found here: [*token-types*](https://github.com/Borewit/token-types).\n\nA token is something which implements the following interface:\n```ts\nexport interface IGetToken<T> {\n\n  /**\n   * Length in bytes of encoded value\n   */\n  len: number;\n\n  /**\n   * Decode value from buffer at offset\n   * @param buf Buffer to read the decoded value from\n   * @param off Decode offset\n   */\n  get(buf: Buffer, off: number): T;\n}\n```\nThe *tokenizer* reads `token.len` bytes from the *tokenizer-stream* into a Buffer.\nThe `token.get` will be called with the Buffer. `token.get` is responsible for conversion from the buffer to the desired output type.\n\n## Browser compatibility\nTo exclude fs based dependencies, you can use a submodule-import from 'strtok3/lib/core'.\n\n| function              | 'strtok3'           | 'strtok3/lib/core'  |\n| ----------------------| --------------------|---------------------|\n| `parseBuffer`         | ✓                   | ✓                   |\n| `parseStream`         | ✓                   | ✓                   |\n| `fromFile`            | ✓                   |                     |\n\n### Working with Web-API readable stream\nTo convert a [Web-API readable stream](https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultReader) into a [Node.js readable stream]((https://nodejs.org/api/stream.html#stream_readable_streams)), you can use [readable-web-to-node-stream](https://github.com/Borewit/readable-web-to-node-stream) to convert one in another.\n\nExample submodule-import:\n```js\nconst strtok3core = require('strtok3/lib/core'); // Submodule-import to prevent Node.js specific dependencies\nconst {ReadableWebToNodeStream} = require('readable-web-to-node-stream');\n\n(async () => {\n\n  const response = await fetch(url);\n  const readableWebStream = response.body; // Web-API readable stream\n  const nodeStream = new ReadableWebToNodeStream(readableWebStream); // convert to Node.js readable stream\n  \n  const tokenizer = strtok3core.fromStream(nodeStream); // And we now have tokenizer in a web environment\n})();\n```\n\n## Licence\n\n(The MIT License)\n\nCopyright (c) 2020 Borewit\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the 'Software'), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
    "licenseText": "Copyright (c) 2017, Borewit\nAll rights reserved.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\ndocumentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the\nrights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit\npersons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the\nSoftware.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\nWARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\nOTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.yarnpkg.com/strtok3/-/strtok3-6.3.0.tgz#358b80ffe6d5d5620e19a073aa78ce947a90f9a0",
    "type": "tarball",
    "reference": "https://registry.yarnpkg.com/strtok3/-/strtok3-6.3.0.tgz",
    "hash": "358b80ffe6d5d5620e19a073aa78ce947a90f9a0",
    "integrity": "sha512-fZtbhtvI9I48xDSywd/somNqgUHl2L2cstmXCCif0itOf96jeW18MBSyrLuNicYQVkvpOxkZtkzujiTJ9LW5Jw==",
    "registry": "npm",
    "packageName": "strtok3",
    "cacheIntegrity": "sha512-fZtbhtvI9I48xDSywd/somNqgUHl2L2cstmXCCif0itOf96jeW18MBSyrLuNicYQVkvpOxkZtkzujiTJ9LW5Jw== sha1-NYuA/+bV1WIOGaBzqnjOlHqQ+aA="
  },
  "registry": "npm",
  "hash": "358b80ffe6d5d5620e19a073aa78ce947a90f9a0"
}